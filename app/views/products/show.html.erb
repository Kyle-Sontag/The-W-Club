<div class="row">
  <div class="col-md-6">
    <% if @product.image.attached? %>
      <%= image_tag @product.image.variant(:large), alt: @product.name, class: "img-fluid" %>
    <% else %>
      <div class="bg-secondary text-white text-center py-5">No Image Available</div>
    <% end %>
  </div>

  <div class="col-md-6">
    <h1><%= @product.name %></h1>

    <p class="text-muted">
      Category: <%= link_to @product.category.name, category_path(@product.category) %>
    </p>

    <div class="mb-3">
      <% if @product.sale_price %>
        <p class="text-decoration-line-through text-muted">$<%= number_with_precision(@product.price, precision: 2) %></p>
        <h3 class="text-danger">Sale Price: $<%= number_with_precision(@product.sale_price, precision: 2) %></h3>
      <% else %>
        <h3>$<%= number_with_precision(@product.price, precision: 2) %></h3>
      <% end %>
    </div>

    <div class="mb-4">
      <h5>Description</h5>
      <p><%= @product.description %></p>
    </div>

    <%= button_to "Add to Cart", cart_items_path(product_id: @product.id), method: :post, class: "btn btn-primary btn-lg mb-3" %>

    <%= link_to "â† Back", session[:product_return_to] || category_path(@product.category), class: "btn btn-secondary mb-4" %>
  </div>
</div>

<hr class="my-5">

<div class="related-products">
  <h2 class="mb-4">More from <%= @product.category.name %></h2>
  <div class="row">
    <%= render partial: 'product_card', collection: @product.category.products.where.not(id: @product.id).limit(4), as: :product %>
  </div>
</div>